<div class="card h-100 shadow-sm">
  <div class="position-relative">
    <img
      [src]="product.imageUrl"
      [alt]="product.name"
      class="card-img-top product-image"
      (error)="onImageError()"
    >
    <span class="position-absolute top-0 end-0 m-2 badge bg-primary">
      {{ product.category }}
    </span>
    <span *ngIf="product.stock < 10" class="position-absolute top-0 start-0 m-2 badge bg-warning">
      Stock bas
    </span>
  </div>

  <div class="card-body d-flex flex-column">
    <h5 class="card-title text-truncate">{{ product.name }}</h5>

    <p class="card-text text-muted small flex-grow-1">
      {{ product.description || 'Aucune description' }}
    </p>

    <div class="d-flex justify-content-between align-items-center mt-3">
      <span class="h5 mb-0 text-primary">
        {{ product.price }} FG
      </span>

      <div class="d-flex align-items-center">
        <span class="badge" [class.bg-secondary]="product.stock > 10"
              [class.bg-warning]="product.stock <= 10 && product.stock > 0"
              [class.bg-danger]="product.stock === 0">
          Stock: {{ product.stock }}
        </span>

        <button
          class="btn btn-primary btn-sm ms-2"
          (click)="onAddToCart()"
          [disabled]="product.stock === 0"
          [class.btn-success]="isInCart"
        >
          <i class="bi" [class.bi-cart-plus]="!isInCart" [class.bi-cart-check]="isInCart"></i>
          {{ isInCart ? 'Déjà ajouté' : 'Ajouter' }}
        </button>
      </div>
    </div>
  </div>
</div>
